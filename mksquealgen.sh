
cat > squealgen <<'EOF'
#!/bin/bash
# NB: this file is generated by mksquealgen.sh, don't edit it directly

if [ "$#" -lt 3 ]; then
    echo "Usage: squealgen DBNAME MODULENAME SCHEMA [IMPORTS]";
    exit 1;
fi
DBNAME=$1
MODULENAME=$2
SCHEMA=$3
IMPORTS=$4 # this can be empty.
EOF

echo 'PSQLCMD=${PSQLCMD:-psql}' >> squealgen
echo '$PSQLCMD -d "${DBNAME}" -v chosen_schema="${SCHEMA}" -v modulename="${MODULENAME}" -v extra_imports="${IMPORTS}" <<"EOF"' >> squealgen
cat squealgen.sql >> squealgen
echo "EOF" >> squealgen
chmod 755 squealgen
